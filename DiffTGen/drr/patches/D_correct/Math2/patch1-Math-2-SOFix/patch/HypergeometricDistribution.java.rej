***************
*** 134,140 ****
              }
              k = 1.0 / k;
              tmp = mu + k * sigma;
-             if (tmp < upper) {
                  upper = ((int) Math.ceil(tmp)) - 1;
              }
          }
--- 134,140 ----
              }
              k = 1.0 / k;
              tmp = mu + k * sigma;
+             if (tmp >= upper) {
                  upper = ((int) Math.ceil(tmp)) - 1;
              }
          }
