***************
*** 941,947 ****
              endIndex = -(endIndex + 1); // this is first item AFTER end period
              endIndex = endIndex - 1;    // so this is last item BEFORE end
          }
-         if (endIndex < 0) {
              emptyRange = true;
          }
          if (emptyRange) {
--- 941,947 ----
              endIndex = -(endIndex + 1); // this is first item AFTER end period
              endIndex = endIndex - 1;    // so this is last item BEFORE end
          }
+         if ((endIndex < 0)  || (endIndex >= startIndex) == false) {
              emptyRange = true;
          }
          if (emptyRange) {
